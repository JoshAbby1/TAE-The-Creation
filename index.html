<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TAE Creations – AI Generator</title>
 <style>
:root{
  /* brand colours */
  --bg:      #A8B48F;  /* sage green background */
  --panel:   #B7C19C;  /* slightly lighter sage for cards */
  --text:    #3B2E2A;  /* dark brown text */
  --muted:   #5A4A44;  /* medium brown for hints */
  --brand:   #3B2E2A;  /* button colour (dark brown) */
}

/* base layout */
body {
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, Arial, sans-serif;
  margin: 0;
  padding: 24px;
  display: flex;
  justify-content: center;
}

.wrap {
  width: 100%;
  max-width: 820px;
}

h1 {
  margin: 0 0 16px;
  color: var(--text);
  text-align: center;
}

/* cards and containers */
.card {
  background: var(--panel);
  border: 1px solid rgba(59,46,42,.25);
  border-radius: 14px;
  padding: 16px;
  margin: 12px 0;
}

/* form inputs */
textarea,
input[type="file"],
select {
  width: 100%;
  background: rgba(255,255,255,.45);
  color: var(--text);
  border: 1px solid rgba(59,46,42,.25);
  border-radius: 10px;
  padding: 10px;
  font-size: 15px;
}

/* checkbox groups */
.checks {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 8px;
}

.checks label {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 12px;
  border: 1px solid rgba(59,46,42,.25);
  border-radius: 10px;
  background: rgba(255,255,255,.45);
  color: var(--text);
  cursor: pointer;
  user-select: none;
  font-size: 14px;
}

.checks input {
  display: none;
}

.checks input:checked + span {
  border-bottom: 2px solid var(--text);
  font-weight: 600;
}

/* buttons */
button {
  width: 100%;
  background: var(--brand);
  color: #F3EFED;
  border: 0;
  border-radius: 10px;
  padding: 14px;
  font-weight: 700;
  cursor: pointer;
  font-size: 16px;
  margin-top: 10px;
}

button[disabled] {
  opacity: .6;
  cursor: not-allowed;
}

/* links and mini buttons */
.gem-btn {
  display: inline-block;
  padding: 10px 14px;
  border-radius: 10px;
  background: var(--brand);
  color: #F3EFED;
  font-weight: 700;
  text-decoration: none;
  transition: opacity .2s ease;
}

.gem-btn:hover {
  opacity: .9;
}

/* text hints and messages */
.muted {
  color: var(--muted);
  font-size: 13px;
  margin-top: 4px;
}

#status {
  margin-top: 8px;
  color: var(--muted);
}

#error {
  margin-top: 8px;
  color: #8B2E2E; /* dark reddish brown */
  font-weight: 600;
}

#result img {
  max-width: 100%;
  border-radius: 12px;
  border: 1px solid rgba(59,46,42,.25);
  margin-top: 10px;
  display: block;
}
</style>
</head>
<body>
  <h1>TAE Creations – AI Generator</h1>

  <!-- Prompt input -->
  <label for="prompt">Prompt</label>
  <textarea id="prompt" placeholder="Describe what you want (e.g., 'man wearing black tracksuit, cinematic lighting, ultra-realistic, 85mm lens')"></textarea>

  <!-- Upload photo input -->
  <label for="photo">Upload reference photo (optional)</label>
  <input id="photo" type="file" accept="image/*" />

  <div class="hint">
    Upload a photo if you want the AI to keep your appearance —  
    or leave it blank to generate a new realistic image from your prompt.<br><br>
    <strong>Both come out watermark-free.</strong>
  </div>

  <!-- Strength slider -->
  <div class="range">
    <span>Match</span>
    <input id="strength" type="range" min="0.20" max="0.70" step="0.05" value="0.35" />
    <span>Style</span>
  </div>
  <div class="hint">Lower = closer to uploaded photo. Try 0.30–0.40 for best likeness.</div>

  <!-- Generate button -->
  <button id="generate">Generate (9:16)</button>
  <div id="status"></div>
  <div id="result"></div>

  <script>
    const btn = document.getElementById("generate");
    const statusEl = document.getElementById("status");
    const resultEl = document.getElementById("result");

    function setStatus(t){ statusEl.textContent = t || ""; }

    // Convert uploaded file to Base64
    function fileToBase64(file){
      return new Promise((resolve, reject)=>{
        const reader = new FileReader();
        reader.onload = () => resolve(String(reader.result).split(",")[1]);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // Main button click
    btn.addEventListener("click", async () => {
      setStatus(""); resultEl.innerHTML = "";
      const prompt = document.getElementById("prompt").value.trim();
      const file = document.getElementById("photo").files[0];
      const strength = Number(document.getElementById("strength").value || 0.35);

      if (!prompt) { setStatus("Please enter a prompt."); return; }

      btn.disabled = true;
      btn.textContent = "Generating…";
      setStatus("Working its magic… (20–40s)");

      try {
        let imageBase64 = "";
        if (file) imageBase64 = await fileToBase64(file);

        const res = await fetch("/api/render", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            prompt,
            ratio: "9:16",
            strength,
            imageBase64
          })
        });

        const data = await res.json();
        if (!res.ok) throw new Error((data.error || "Generation failed.") + (data.details ? " — " + data.details : ""));

        resultEl.innerHTML = `<img src="${data.imageUrl}" alt="Generated result">`;
        setStatus("Done ✅");
      } catch (err) {
        console.error(err);
        setStatus("Error: " + err.message);
      } finally {
        btn.disabled = false;
        btn.textContent = "Generate (9:16)";
      }
    });
  </script>
</body>
</html>
